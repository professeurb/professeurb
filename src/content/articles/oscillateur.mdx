---
title: Oscillateur harmonique et méthodes numériques
subtitle: Où l'on compare différentes méthodes d'intégration numérique…
---

On a un oscillateur harmonique, ce qui correspond à l'équation différentielle

$$
\ddot x + \omega^2 x = 0
$$

# Étude mathématique

## Solution exacte

Les solutions sont de la forme
$$
x(t) = A \sin(\omega t + \varphi)
$$

Sous forme discrétisée,

```python
x[n] = A * sin(omega * n * dt + phi)
v[n] = A * omega * cos(omega * n * dt + phi)
```


$$
\begin{aligned}
x_{n+1} & = A \sin (\omega n dt + \varphi + \omega dt) \\
& = A \sin(\omega n dt + \varphi) \cos(\omega dt) + A \cos(\omega n dt + \varphi) \sin(\omega dt) \\
& = \cos(\omega d t) x_n + \frac 1 \omega \sin(\omega d t) v_n \\
v_{n+1} & = A \omega \cos(\omega n dt + \varphi) \cos(\omega dt) - A \omega \sin(\omega n dt + \varphi) \sin(\omega dt) \\
& = \cos(\omega dt) v_n - \omega \sin(\omega dt) x_n
\end{aligned}
$$

Sous forme matricielle, on a @@@problème de signe sur le sinus@@@
$$
\begin{pmatrix}
\cos (\omega dt) & \frac 1 \omega \sin(\omega dt) \\
- \omega \sin(\omega dt) & \cos(\omega dt)
\end{pmatrix}
$$

Les valeurs propres sont donc $\cos(\omega dt) \pm i \sin(\omega dt) = e^{\pm i \omega dt} $ de valeurs propres associées $\begin{pmatrix} 1 \\ \pm i \omega\end{pmatrix} $.

## Méthode d'Euler explicite

Approche

```python
x[n + 1] = x[n] + v[n] * dt
v[n + 1] = v[n] - omega2 * x[n] * dt
```

Sous forme matricielle,
$$
\begin{pmatrix}
x_{n+1} \\ v_{n+1}
\end{pmatrix}
= \begin{pmatrix}
1 & dt \\ - \omega^2 dt & 1
\end{pmatrix}
\begin{pmatrix}
x_n \\ v_n
\end{pmatrix}
$$

Les valeurs propres sont $1 \pm i \omega dt$, de vecteurs propres associés $\begin{pmatrix} 1 \\ \pm i \omega \end{pmatrix} $.

## Méthode d'Euler implicite

$$
\begin{pmatrix}
x_{n+1} \\ v_{n+1}
\end{pmatrix}
= \begin{pmatrix}
x_n \\ v_n
\end{pmatrix} + \begin{pmatrix}
0 & dt \\ - \omega^2 dt & 0
\end{pmatrix}
\begin{pmatrix}
x_{n + 1} \\ v_{n + 1}
\end{pmatrix}
$$

soit

$$
\begin{pmatrix}
x_n \\ v_n
\end{pmatrix}
= \begin{pmatrix}
1 & - dt \\ \omega^2 dt & 1
\end{pmatrix}
\begin{pmatrix}
x_{n + 1} \\ v_{n + 1}
\end{pmatrix}
$$

Les valeurs propres sont
$$
\frac {1 \pm i \omega dt}{1 + \omega^2 dt^2} = \frac 1 {1 \mp i \omega dt}
$$
de vecteurs propres $(1, \pm i \omega dt)$

Le produit des v.p. est $1/(1 + \omega^2 dt^2)$…

## Méthode de Heun

On pose

$$
\tilde y_{n + 1} = y_n + f(t_n, y_n) d t \qquad y_{n + 1} = y_n + \bigl(f(t_n, y_n) + f(t_{n + 1}, \tilde y_{n + 1})\bigr) \times \frac {dt} 2
$$

On utilise la matrixe
$$
\begin{pmatrix}
1 - \frac 1 2 \omega^2 dt^2 & dt \\
- \omega^2 dt & 1 - \frac 1 2 \omega^2 dt^2
\end{pmatrix}
$$

Les valeurs propres sont $1 \pm i \omega dt - \frac 1 2 \omega^2 dt^2$, de produit $1 + \frac 1 4 \omega^4 dt^4$. Les vecteurs propres sont corrects, $(1, \pm i \omega dt)$.

## Méthode de Runge-Kutta 2

## Méthode semi-implicite

```python
v[n + 1] = v[n] - omega2 * x[n] * dt
x[n + 1] = x[n] + v[n + 1] * dt
```

On a $x_{n + 1} = x_n + (v_n - \omega^2 x_n) dt$, d'où la matrice

$$
\begin{pmatrix}
1 - \omega^2 dt^2 & dt \\
- \omega^2 dt & 1
\end{pmatrix}
$$

Les valeurs propres sont alors
$$
1 - \frac 1 2 \omega^2 dt^2 \pm \frac 1 2 \sqrt{-4 + \omega^2 dt^2}
$$
dont le produit vaut $1$.

La fréquence n'est plus la bonne… c'est maintenant
$$
\arccos\Bigl(1 - \frac 1 2 \omega^2 dt^2\Bigr) = \omega dt + \frac 1 {24} \omega^3 dt^3 + O(dt^5)
$$